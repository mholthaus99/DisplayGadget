<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: src/network/weather.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('weather_8cpp.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">weather.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implements weather data fetching and caching for an ESP8266-based project.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="weather_8h_source.html">weather.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="secrets_8h_source.html">secrets.h</a>&quot;</code><br />
<code>#include &lt;ArduinoJson.h&gt;</code><br />
<code>#include &lt;ESP8266HTTPClient.h&gt;</code><br />
<code>#include &lt;WiFiClientSecure.h&gt;</code><br />
<code>#include &lt;ESP8266WiFi.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-namespaces" class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:Weather" id="r_Weather"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html">Weather</a></td></tr>
<tr class="memdesc:namespace_weather"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespace_weather.html" title="Weather namespace for fetching and accessing weather data.">Weather</a> namespace for fetching and accessing weather data. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab1486980f26cf9cf55d52ddb9d3ebce5" id="r_ab1486980f26cf9cf55d52ddb9d3ebce5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#ab1486980f26cf9cf55d52ddb9d3ebce5">Weather::fetch</a> ()</td></tr>
<tr class="memdesc:ab1486980f26cf9cf55d52ddb9d3ebce5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to fetch the latest weather data.  <br /></td></tr>
<tr class="memitem:a488f1e02bc098cfd852b4c4fe8ffd589" id="r_a488f1e02bc098cfd852b4c4fe8ffd589"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#a488f1e02bc098cfd852b4c4fe8ffd589">Weather::init</a> ()</td></tr>
<tr class="memdesc:a488f1e02bc098cfd852b4c4fe8ffd589"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the weather module and fetches initial weather data.  <br /></td></tr>
<tr class="memitem:aad9bbd20aef34e7f92992d46d062618c" id="r_aad9bbd20aef34e7f92992d46d062618c"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#aad9bbd20aef34e7f92992d46d062618c">Weather::getSummary</a> ()</td></tr>
<tr class="memdesc:aad9bbd20aef34e7f92992d46d062618c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a formatted weather summary string.  <br /></td></tr>
<tr class="memitem:ae3ad8f633ca9dff20651a5a7ccfc84bf" id="r_ae3ad8f633ca9dff20651a5a7ccfc84bf"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#ae3ad8f633ca9dff20651a5a7ccfc84bf">Weather::getDescription</a> ()</td></tr>
<tr class="memdesc:ae3ad8f633ca9dff20651a5a7ccfc84bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the weather description string.  <br /></td></tr>
<tr class="memitem:a1f94f0f06902f6ff5400f361cafeb2b9" id="r_a1f94f0f06902f6ff5400f361cafeb2b9"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#a1f94f0f06902f6ff5400f361cafeb2b9">Weather::getLocation</a> ()</td></tr>
<tr class="memdesc:a1f94f0f06902f6ff5400f361cafeb2b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the location/city string.  <br /></td></tr>
<tr class="memitem:a9e78394e960dee8718c5894feeefbee0" id="r_a9e78394e960dee8718c5894feeefbee0"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#a9e78394e960dee8718c5894feeefbee0">Weather::getTemperature</a> ()</td></tr>
<tr class="memdesc:a9e78394e960dee8718c5894feeefbee0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the temperature string.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad6988b11cc4969605fbe1f9c732604f0" id="r_ad6988b11cc4969605fbe1f9c732604f0"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#ad6988b11cc4969605fbe1f9c732604f0">Weather::weatherSummary</a> = &quot;Weather data not yet fetched&quot;</td></tr>
<tr class="memitem:a59a7127c54d5f68ef743c187b7493404" id="r_a59a7127c54d5f68ef743c187b7493404"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#a59a7127c54d5f68ef743c187b7493404">Weather::cachedLocation</a> = &quot;Unknown&quot;</td></tr>
<tr class="memitem:ad2294c8097c6e3055b78670175d3a0fb" id="r_ad2294c8097c6e3055b78670175d3a0fb"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#ad2294c8097c6e3055b78670175d3a0fb">Weather::cachedTemp</a> = &quot;--F&quot;</td></tr>
<tr class="memitem:a1002a1e4f6a6edc9004c2fac00012183" id="r_a1002a1e4f6a6edc9004c2fac00012183"><td class="memItemLeft" align="right" valign="top">static String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#a1002a1e4f6a6edc9004c2fac00012183">Weather::cachedDesc</a> = &quot;Unavailable&quot;</td></tr>
<tr class="memitem:a21e4b3ef7fa9b5827faf9653d7f0a8c9" id="r_a21e4b3ef7fa9b5827faf9653d7f0a8c9"><td class="memItemLeft" align="right" valign="top">static unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#a21e4b3ef7fa9b5827faf9653d7f0a8c9">Weather::lastWeatherFetchMillis</a> = 0</td></tr>
<tr class="memitem:a87df8c0b2b7166ee1e1951039a9b4a06" id="r_a87df8c0b2b7166ee1e1951039a9b4a06"><td class="memItemLeft" align="right" valign="top">const unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_weather.html#a87df8c0b2b7166ee1e1951039a9b4a06">Weather::UPDATE_INTERVAL</a> = 10UL * 60UL * 1000UL</td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements weather data fetching and caching for an ESP8266-based project. </p>
<p>This module provides functions to fetch current weather data from the OpenWeatherMap API, cache the results, and provide access to weather summary, description, location, and temperature. The data is refreshed at a configurable interval (default: 10 minutes).</p>
<p>Dependencies:</p><ul>
<li>ArduinoJson for JSON parsing</li>
<li>ESP8266HTTPClient and WiFiClientSecure for HTTPS requests</li>
<li>ESP8266WiFi for WiFi connectivity</li>
</ul>
<p>Namespace: <a class="el" href="namespace_weather.html" title="Weather namespace for fetching and accessing weather data.">Weather</a></p>
<p>Static Variables:</p><ul>
<li>weatherSummary: Cached summary string of the latest weather data.</li>
<li>cachedLocation: Cached city/location name.</li>
<li>cachedTemp: Cached temperature string.</li>
<li>cachedDesc: Cached weather description.</li>
<li>lastWeatherFetchMillis: Timestamp of the last successful fetch.</li>
<li>UPDATE_INTERVAL: Interval (ms) between automatic weather data refreshes.</li>
</ul>
<p>Functions:</p><ul>
<li>bool fetch(): Fetches weather data from the API, updates caches, and returns success status.</li>
<li>void init(): Initializes the weather module and performs an initial fetch.</li>
<li>const char* getSummary(): Returns a summary string, refreshing data if needed.</li>
<li>const char* getDescription(): Returns the cached weather description.</li>
<li>const char* getLocation(): Returns the cached location/city name.</li>
<li>const char* getTemperature(): Returns the cached temperature string.</li>
</ul>
<p>Error Handling:</p><ul>
<li>Handles WiFi disconnection, HTTP errors, and JSON parsing errors with appropriate cache updates.</li>
</ul>
<p>Usage:</p><ol type="1">
<li>Call <a class="el" href="namespace_weather.html#a488f1e02bc098cfd852b4c4fe8ffd589" title="Initializes the weather module and fetches initial weather data.">Weather::init()</a> at startup.</li>
<li>Use getter functions to retrieve weather information as needed. </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="dir_fc4c7f03e1a69a98c370fae55a743828.html">network</a></li><li class="navelem"><a href="weather_8cpp.html">weather.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
